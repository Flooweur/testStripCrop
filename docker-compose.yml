# ============================================================================
# Docker Compose Configuration
# ============================================================================
# Use this file to easily run the Pool Test Strip Cropper service
# 
# Commands:
#   Start:   docker-compose up -d
#   Stop:    docker-compose down
#   Logs:    docker-compose logs -f
#   Rebuild: docker-compose up -d --build
# ============================================================================

version: '3.8'

services:
  test-strip-cropper:
    # Build the image from the Dockerfile in current directory
    build:
      context: .
      dockerfile: Dockerfile
    
    # Container name for easy reference
    container_name: test-strip-cropper
    
    # Port mapping: host:container
    ports:
      - "8080:8080"
    
    # Mount the output directory to persist cropped images
    volumes:
      - ./output:/app/output
    
    # Environment variables
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
    
    # Restart policy
    restart: unless-stopped
    
    # Health check configuration
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s
